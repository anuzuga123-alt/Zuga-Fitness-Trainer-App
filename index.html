<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zuga Fitness Trainer</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#00bfa6">
<style>
:root {
  --green: #00bfa6;
  --dark: #004e45;
  --light: #f0fff9;
  --present: #a7f3d0;
  --absent: #fecaca;
  --holiday: #fef9c3;
  --freeze: #bfdbfe;
}
body {
  font-family: "Poppins", sans-serif;
  background: var(--light);
  margin: 0;
  padding: 0;
  color: #222;
}
header {
  background: var(--green);
  color: white;
  text-align: center;
  padding: 12px;
  font-size: 18px;
  font-weight: 600;
  position: sticky;
  top: 0;
}
.container {
  padding: 14px;
  max-width: 480px;
  margin: auto;
}
button {
  background: var(--green);
  color: white;
  border: none;
  border-radius: 8px;
  padding: 10px;
  font-weight: 600;
  cursor: pointer;
  width: 100%;
}
.card {
  background: white;
  padding: 14px;
  border-radius: 12px;
  margin-bottom: 14px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}
input, select, textarea {
  width: 100%;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  margin-bottom: 10px;
  font-family: inherit;
}
h3 {
  margin: 0 0 10px;
  color: var(--dark);
}
.client-list-item {
  background: white;
  padding: 12px;
  border-radius: 10px;
  margin-bottom: 8px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.client-list-item span {
  font-weight: 600;
  color: var(--dark);
  cursor: pointer;
}

/* ===== Calendar ===== */
.calendar {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 6px;
  justify-items: center;
}
.day {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: 2px solid #ddd;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: 500;
  background: white;
  transition: 0.2s;
}
.day.present { background: var(--present); border-color: #34d399; }
.day.absent { background: var(--absent); border-color: #f87171; }
.day.holiday { background: var(--holiday); border-color: #facc15; }
.day.freeze { background: var(--freeze); border-color: #60a5fa; }
.day.selected { outline: 3px solid var(--green); transform: scale(1.1); }

/* ===== Responsive ===== */
@media (max-width: 600px) {
  .calendar { gap: 4px; }
  .day { width: 36px; height: 36px; font-size: 14px; }
}
</style>
</head>
<body>

<header>Zuga Trainer</header>
<div class="container" id="app">

  <!-- Home -->
  <div id="home">
    <h3>Your Clients</h3>
    <div id="clientList"></div>
    <button onclick="showAddClient()">Add New Client</button>
  </div>

  <!-- Add Client -->
  <div id="addClient" style="display:none;">
    <div class="card">
      <h3>Add Client</h3>
      <input id="cName" placeholder="Full Name">
      <input id="cAge" placeholder="Age">
      <input id="cHeight" placeholder="Height (cm)">
      <input id="cWeight" placeholder="Weight (kg)">
      <input id="cMedical" placeholder="Medical Condition">
      <input id="cInjury" placeholder="Injuries (if any)">
      <input id="cJoin" type="date" placeholder="Join Date">
      <input id="cRenew" type="date" placeholder="Renewal Date">
      <button onclick="saveClient()">Save</button>
      <button style="background:#ccc;margin-top:8px;" onclick="showHome()">Cancel</button>
    </div>
  </div>

  <!-- Client Page -->
  <div id="clientPage" style="display:none;">
    <button style="margin-bottom:10px;" onclick="showHome()">â¬… Back</button>
    <div id="clientInfo" class="card"></div>
    <div class="card">
      <h3>Attendance Calendar</h3>
      <div id="calendar" class="calendar"></div>
    </div>
    <div class="card" id="dayInfo">
      <h3>Day Info</h3>
      <p id="selectedDate">Select a date from the calendar.</p>
      <select id="attendanceSelect" onchange="updateDayStatus()">
        <option value="">Select Status</option>
        <option value="present">Present</option>
        <option value="absent">Absent</option>
        <option value="holiday">Holiday</option>
        <option value="freeze">Freeze</option>
      </select>
      <textarea id="practiceNotes" placeholder="What was practiced today?"></textarea>
      <button onclick="downloadReport()">Download Monthly Report</button>
    </div>
  </div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
let clients = JSON.parse(localStorage.getItem("clients")||"[]");
let currentClient = null;
let attendance = JSON.parse(localStorage.getItem("attendance")||"{}");
let selectedDate = null;

/* Navigation */
function showHome(){
  document.getElementById("home").style.display="block";
  document.getElementById("addClient").style.display="none";
  document.getElementById("clientPage").style.display="none";
  loadClients();
}
function showAddClient(){
  document.getElementById("home").style.display="none";
  document.getElementById("addClient").style.display="block";
}

/* Save & Load Clients */
function saveClient(){
  const c={
    id: Date.now(),
    name: cName.value,
    age: cAge.value,
    height: cHeight.value,
    weight: cWeight.value,
    medical: cMedical.value,
    injury: cInjury.value,
    join: cJoin.value,
    renew: cRenew.value
  };
  clients.push(c);
  localStorage.setItem("clients",JSON.stringify(clients));
  showHome();
}
function loadClients(){
  const list=document.getElementById("clientList");
  list.innerHTML="";
  clients.forEach(c=>{
    const div=document.createElement("div");
    div.className="client-list-item";
    div.innerHTML=`<span onclick="openClient(${c.id})">${c.name}</span> 
                   <button onclick="deleteClient(${c.id})" style="width:auto;background:none;color:red;">ðŸ—‘</button>`;
    list.appendChild(div);
  });
}
function deleteClient(id){
  clients = clients.filter(c=>c.id!==id);
  localStorage.setItem("clients",JSON.stringify(clients));
  loadClients();
}

/* Open Client */
function openClient(id){
  currentClient = clients.find(c=>c.id===id);
  document.getElementById("home").style.display="none";
  document.getElementById("clientPage").style.display="block";
  document.getElementById("clientInfo").innerHTML = `
    <h3>${currentClient.name}</h3>
    <p><b>Age:</b> ${currentClient.age}</p>
    <p><b>Height:</b> ${currentClient.height} cm | <b>Weight:</b> ${currentClient.weight} kg</p>
    <p><b>Medical:</b> ${currentClient.medical || '-'}</p>
    <p><b>Injury:</b> ${currentClient.injury || '-'}</p>
    <p><b>Join:</b> ${currentClient.join}</p>
    <p><b>Renew:</b> ${currentClient.renew}</p>
  `;
  buildCalendar();
}

/* Build Calendar */
function buildCalendar(){
  const calendar=document.getElementById("calendar");
  calendar.innerHTML="";
  const today=new Date();
  const monthKey=today.toISOString().slice(0,7);
  const totalDays=new Date(today.getFullYear(),today.getMonth()+1,0).getDate();
  if(!attendance[currentClient.id]) attendance[currentClient.id]={};
  if(!attendance[currentClient.id][monthKey]) attendance[currentClient.id][monthKey]={};
  
  for(let i=1;i<=totalDays;i++){
    const dateStr=`${monthKey}-${String(i).padStart(2,'0')}`;
    const dayDiv=document.createElement("div");
    dayDiv.className="day";
    const status=attendance[currentClient.id][monthKey][dateStr];
    if(status) dayDiv.classList.add(status);
    dayDiv.textContent=i;
    dayDiv.onclick=()=>selectDay(dateStr, dayDiv);
    calendar.appendChild(dayDiv);
  }
}

/* Select Date */
function selectDay(dateStr, el){
  document.querySelectorAll(".day").forEach(d=>d.classList.remove("selected"));
  el.classList.add("selected");
  selectedDate=dateStr;
  document.getElementById("selectedDate").textContent="Selected Date: "+dateStr;
  const status=attendance[currentClient.id][dateStr];
  document.getElementById("attendanceSelect").value=status||"";
  document.getElementById("practiceNotes").value=attendance[currentClient.id][dateStr+"_note"]||"";
}

/* Update Day Status */
function updateDayStatus(){
  if(!selectedDate) return alert("Select a date first!");
  const val=document.getElementById("attendanceSelect").value;
  const note=document.getElementById("practiceNotes").value;
  attendance[currentClient.id][selectedDate]=val;
  attendance[currentClient.id][selectedDate+"_note"]=note;
  localStorage.setItem("attendance",JSON.stringify(attendance));
  buildCalendar();
}

/* Download Report */
async function downloadReport(){
  const { jsPDF } = window.jspdf;
  const doc=new jsPDF();
  const monthKey=new Date().toISOString().slice(0,7);
  doc.text(`Zuga Fitness - ${currentClient.name} Monthly Report`,10,10);
  let y=20;
  const days=attendance[currentClient.id];
  for(let date in days){
    if(date.includes(monthKey)){
      doc.text(`${date}: ${days[date]||'-'} - ${days[date+"_note"]||''}`,10,y);
      y+=6;
    }
  }
  doc.save(`${currentClient.name}_report.pdf`);
}

loadClients();
</script>
  <script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js')
  .then(() => console.log('âœ… Service Worker registered successfully'))
  .catch(err => console.log('Service Worker registration failed:', err));
}
</script>
</body>
</html>
