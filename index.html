<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zuga Fitness Trainer</title>
    <meta name="theme-color" content="#00bfa6">
    <meta name="description" content="Fitness trainer client management app">
    <link rel="manifest" href="manifest.json">
    <style>
        /* CSS Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #00bfa6;
            --primary-dark: #009688;
            --primary-light: #e0f2f1;
            --white: #ffffff;
            --light-gray: #f5f5f5;
            --gray: #e0e0e0;
            --dark-gray: #757575;
            --text: #212121;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --radius: 12px;
            --transition: all 0.3s ease;
        }

        body {
            background-color: var(--light-gray);
            color: var(--text);
            line-height: 1.6;
            padding-bottom: 70px; /* Space for floating home button */
        }

        /* Common Components */
        .container {
            max-width: 100%;
            padding: 16px;
        }

        .card {
            background: var(--white);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
            transition: var(--transition);
        }

        .card:hover {
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }

        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 191, 166, 0.3);
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 191, 166, 0.4);
        }

        .btn-secondary {
            background-color: var(--light-gray);
            color: var(--text);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .btn-secondary:hover {
            background-color: var(--gray);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-gray);
        }

        input, select, textarea {
            width: 100%;
            padding: 14px;
            border: 2px solid var(--gray);
            border-radius: var(--radius);
            font-size: 16px;
            transition: var(--transition);
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(0, 191, 166, 0.2);
        }

        /* Views */
        .view {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Header */
        .header {
            background-color: var(--primary);
            color: white;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 20px;
        }

        /* Login View */
        .login-card {
            max-width: 400px;
            margin: 40px auto;
            text-align: center;
        }

        .login-card h1 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .login-card p {
            color: var(--dark-gray);
            margin-bottom: 30px;
        }

        .register-link {
            margin-top: 20px;
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            display: inline-block;
        }

        /* Dashboard View */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .client-list {
            list-style: none;
        }

        .client-item {
            padding: 16px;
            border-bottom: 1px solid var(--gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .client-item:hover {
            background-color: var(--primary-light);
        }

        .client-item:last-child {
            border-bottom: none;
        }

        .client-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
        }

        .client-info {
            flex: 1;
        }

        .client-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .client-details {
            font-size: 14px;
            color: var(--dark-gray);
        }

        /* Client Profile View */
        .client-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .client-detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--light-gray);
        }

        .detail-label {
            font-weight: 600;
            color: var(--dark-gray);
        }

        .detail-value {
            text-align: right;
        }

        /* Calendar */
        .calendar {
            margin-bottom: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            background-color: var(--light-gray);
        }

        .calendar-day:hover {
            background-color: var(--gray);
        }

        .calendar-day.selected {
            background-color: var(--primary);
            color: white;
        }

        .calendar-day.present {
            background-color: #4caf50;
            color: white;
        }

        .calendar-day.absent {
            background-color: #f44336;
            color: white;
        }

        .calendar-day.holiday {
            background-color: #ff9800;
            color: white;
        }

        .calendar-day.freeze {
            background-color: #2196f3;
            color: white;
        }

        .calendar-day.empty {
            background-color: transparent;
            cursor: default;
        }

        /* Day Info */
        .day-info-card {
            margin-top: 20px;
        }

        .day-info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--text);
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            box-shadow: var(--shadow);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .toast.show {
            opacity: 1;
        }

        /* Floating Home Button */
        .floating-home {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 100;
            transition: var(--transition);
        }

        .floating-home:hover {
            transform: scale(1.1);
            background-color: var(--primary-dark);
        }

        /* Responsive */
        @media (min-width: 768px) {
            .container {
                max-width: 700px;
                margin: 0 auto;
            }
            
            .client-detail-row {
                display: grid;
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Login View -->
    <div id="loginView" class="view active">
        <div class="container">
            <div class="login-card card">
                <h1>Zuga Fitness Trainer</h1>
                <p>Manage your clients efficiently</p>
                
                <div class="form-group">
                    <label for="loginEmail">Email or Phone</label>
                    <input type="text" id="loginEmail" placeholder="Enter your email or phone">
                </div>
                
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password">
                </div>
                
                <button class="btn" id="loginBtn" style="width: 100%;">Login</button>
                
                <a href="#" class="register-link" id="showRegister">Register new trainer</a>
            </div>
        </div>
    </div>

    <!-- Registration View -->
    <div id="registerView" class="view">
        <div class="container">
            <div class="login-card card">
                <h1>Register as Trainer</h1>
                <p>Create your account to get started</p>
                
                <div class="form-group">
                    <label for="regName">Full Name</label>
                    <input type="text" id="regName" placeholder="Enter your full name">
                </div>
                
                <div class="form-group">
                    <label for="regPhone">Phone</label>
                    <input type="tel" id="regPhone" placeholder="Enter your phone number">
                </div>
                
                <div class="form-group">
                    <label for="regEmail">Email</label>
                    <input type="email" id="regEmail" placeholder="Enter your email">
                </div>
                
                <div class="form-group">
                    <label for="regPassword">Password</label>
                    <input type="password" id="regPassword" placeholder="Create a password">
                </div>
                
                <div class="form-group">
                    <label for="regOTP">OTP (Mock: 123456)</label>
                    <input type="text" id="regOTP" placeholder="Enter OTP">
                </div>
                
                <button class="btn" id="registerBtn" style="width: 100%;">Register</button>
                
                <a href="#" class="register-link" id="showLogin">Back to Login</a>
            </div>
        </div>
    </div>

    <!-- Dashboard View -->
    <div id="dashboardView" class="view">
        <div class="header">
            <div class="logo">
                <span>🏋️</span>
                <span>Zuga Fitness</span>
            </div>
            <button class="btn btn-secondary" id="logoutBtn">Logout</button>
        </div>
        
        <div class="container">
            <div class="dashboard-header">
                <h2>My Clients</h2>
                <button class="btn" id="addClientBtn">+ Add New Client</button>
            </div>
            
            <div class="card">
                <ul class="client-list" id="clientList">
                    <!-- Client list will be populated here -->
                </ul>
            </div>
        </div>
    </div>

    <!-- Client Profile View -->
    <div id="clientView" class="view">
        <div class="header">
            <div class="logo">
                <span>🧘‍♀️</span>
                <span id="clientViewTitle">Client Profile</span>
            </div>
            <button class="btn btn-secondary" id="backToDashboardBtn">Back</button>
        </div>
        
        <div class="container">
            <!-- Client Info Section -->
            <div class="client-header">
                <h2 id="clientName">Client Name</h2>
                <button class="btn" id="editClientBtn">Edit</button>
            </div>
            
            <div class="card" id="clientInfoCard">
                <div class="client-detail-row">
                    <div class="detail-label">Age</div>
                    <div class="detail-value" id="clientAge">-</div>
                </div>
                <div class="client-detail-row">
                    <div class="detail-label">Gender</div>
                    <div class="detail-value" id="clientGender">-</div>
                </div>
                <div class="client-detail-row">
                    <div class="detail-label">Joining Date</div>
                    <div class="detail-value" id="clientJoiningDate">-</div>
                </div>
                <div class="client-detail-row">
                    <div class="detail-label">Renewal Date</div>
                    <div class="detail-value" id="clientRenewalDate">-</div>
                </div>
                <div class="client-detail-row">
                    <div class="detail-label">Height</div>
                    <div class="detail-value" id="clientHeight">-</div>
                </div>
                <div class="client-detail-row">
                    <div class="detail-label">Weight</div>
                    <div class="detail-value" id="clientWeight">-</div>
                </div>
                <div class="client-detail-row">
                    <div class="detail-label">Medical Condition</div>
                    <div class="detail-value" id="clientMedical">-</div>
                </div>
                <div class="client-detail-row">
                    <div class="detail-label">Injuries</div>
                    <div class="detail-value" id="clientInjuries">-</div>
                </div>
            </div>
            
            <!-- Calendar Section -->
            <div class="card calendar">
                <div class="calendar-header">
                    <h3 id="calendarMonth">October 2023</h3>
                    <div>
                        <button class="btn btn-secondary" id="prevMonthBtn">‹</button>
                        <button class="btn btn-secondary" id="nextMonthBtn">›</button>
                    </div>
                </div>
                <div class="calendar-grid" id="calendarGrid">
                    <!-- Calendar days will be populated here -->
                </div>
            </div>
            
            <!-- Day Info Section -->
            <div class="card day-info-card">
                <div class="day-info-header">
                    <h3 id="selectedDate">Selected Date</h3>
                </div>
                
                <div class="form-group">
                    <label for="attendanceSelect">Attendance</label>
                    <select id="attendanceSelect">
                        <option value="">Select status</option>
                        <option value="present">🟢 Present</option>
                        <option value="absent">🔴 Absent</option>
                        <option value="holiday">🟡 Holiday</option>
                        <option value="freeze">🔵 Freeze</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="workoutNotes">Workout Notes</label>
                    <textarea id="workoutNotes" rows="3" placeholder="Enter today's workout details"></textarea>
                </div>
                
                <button class="btn" id="saveDayInfoBtn" style="width: 100%;">Save Day Info</button>
            </div>
            
            <!-- Progress Section -->
            <div class="card">
                <button class="btn" id="downloadReportBtn" style="width: 100%;">Download Monthly Report</button>
            </div>
        </div>
    </div>

    <!-- Edit Client Modal -->
    <div id="editClientModal" class="view">
        <div class="container">
            <div class="login-card card">
                <h2 id="editClientTitle">Edit Client</h2>
                
                <div class="form-group">
                    <label for="editClientName">Name</label>
                    <input type="text" id="editClientName" placeholder="Client name">
                </div>
                
                <div class="form-group">
                    <label for="editClientAge">Age</label>
                    <input type="number" id="editClientAge" placeholder="Age">
                </div>
                
                <div class="form-group">
                    <label for="editClientGender">Gender</label>
                    <select id="editClientGender">
                        <option value="">Select gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="editClientJoiningDate">Joining Date</label>
                    <input type="date" id="editClientJoiningDate">
                </div>
                
                <div class="form-group">
                    <label for="editClientRenewalDate">Renewal Date</label>
                    <input type="date" id="editClientRenewalDate">
                </div>
                
                <div class="form-group">
                    <label for="editClientHeight">Height (cm)</label>
                    <input type="number" id="editClientHeight" placeholder="Height in cm">
                </div>
                
                <div class="form-group">
                    <label for="editClientWeight">Weight (kg)</label>
                    <input type="number" id="editClientWeight" placeholder="Weight in kg">
                </div>
                
                <div class="form-group">
                    <label for="editClientMedical">Medical Condition</label>
                    <input type="text" id="editClientMedical" placeholder="Any medical conditions">
                </div>
                
                <div class="form-group">
                    <label for="editClientInjuries">Injuries</label>
                    <input type="text" id="editClientInjuries" placeholder="Any injuries">
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn" id="saveClientBtn" style="flex: 1;">Save</button>
                    <button class="btn btn-secondary" id="cancelEditBtn" style="flex: 1;">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Client Modal -->
    <div id="addClientModal" class="view">
        <div class="container">
            <div class="login-card card">
                <h2>Add New Client</h2>
                
                <div class="form-group">
                    <label for="newClientName">Name</label>
                    <input type="text" id="newClientName" placeholder="Client name">
                </div>
                
                <div class="form-group">
                    <label for="newClientAge">Age</label>
                    <input type="number" id="newClientAge" placeholder="Age">
                </div>
                
                <div class="form-group">
                    <label for="newClientGender">Gender</label>
                    <select id="newClientGender">
                        <option value="">Select gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="newClientJoiningDate">Joining Date</label>
                    <input type="date" id="newClientJoiningDate">
                </div>
                
                <div class="form-group">
                    <label for="newClientRenewalDate">Renewal Date</label>
                    <input type="date" id="newClientRenewalDate">
                </div>
                
                <div class="form-group">
                    <label for="newClientHeight">Height (cm)</label>
                    <input type="number" id="newClientHeight" placeholder="Height in cm">
                </div>
                
                <div class="form-group">
                    <label for="newClientWeight">Weight (kg)</label>
                    <input type="number" id="newClientWeight" placeholder="Weight in kg">
                </div>
                
                <div class="form-group">
                    <label for="newClientMedical">Medical Condition</label>
                    <input type="text" id="newClientMedical" placeholder="Any medical conditions">
                </div>
                
                <div class="form-group">
                    <label for="newClientInjuries">Injuries</label>
                    <input type="text" id="newClientInjuries" placeholder="Any injuries">
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn" id="saveNewClientBtn" style="flex: 1;">Save</button>
                    <button class="btn btn-secondary" id="cancelAddBtn" style="flex: 1;">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Message -->
    <div id="toast" class="toast"></div>

    <!-- Floating Home Button -->
    <div class="floating-home" id="floatingHomeBtn">🏠</div>

    <script>
        // App State
        const state = {
            currentView: 'login',
            currentTrainer: null,
            currentClient: null,
            currentDate: new Date(),
            selectedDate: null,
            trainers: JSON.parse(localStorage.getItem('zugaTrainers')) || [],
            clients: JSON.parse(localStorage.getItem('zugaClients')) || {}
        };

        // DOM Elements
        const views = {
            login: document.getElementById('loginView'),
            register: document.getElementById('registerView'),
            dashboard: document.getElementById('dashboardView'),
            client: document.getElementById('clientView'),
            editClient: document.getElementById('editClientModal'),
            addClient: document.getElementById('addClientModal')
        };

        // Initialize the app
        function initApp() {
            // Check if user is already logged in
            const savedTrainer = localStorage.getItem('currentTrainer');
            if (savedTrainer) {
                state.currentTrainer = JSON.parse(savedTrainer);
                showView('dashboard');
                renderClientList();
            }

            // Set up event listeners
            setupEventListeners();
            
            // Set default dates for new client form
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('newClientJoiningDate').value = today;
            
            // Set renewal date to 30 days from today
            const renewalDate = new Date();
            renewalDate.setDate(renewalDate.getDate() + 30);
            document.getElementById('newClientRenewalDate').value = renewalDate.toISOString().split('T')[0];
        }

        // Set up all event listeners
        function setupEventListeners() {
            // Login/Registration
            document.getElementById('loginBtn').addEventListener('click', handleLogin);
            document.getElementById('registerBtn').addEventListener('click', handleRegister);
            document.getElementById('showRegister').addEventListener('click', () => showView('register'));
            document.getElementById('showLogin').addEventListener('click', () => showView('login'));
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            
            // Dashboard
            document.getElementById('addClientBtn').addEventListener('click', () => showView('addClient'));
            document.getElementById('backToDashboardBtn').addEventListener('click', () => showView('dashboard'));
            
            // Client View
            document.getElementById('editClientBtn').addEventListener('click', () => showEditClientForm());
            document.getElementById('saveDayInfoBtn').addEventListener('click', saveDayInfo);
            document.getElementById('downloadReportBtn').addEventListener('click', downloadMonthlyReport);
            
            // Calendar Navigation
            document.getElementById('prevMonthBtn').addEventListener('click', prevMonth);
            document.getElementById('nextMonthBtn').addEventListener('click', nextMonth);
            
            // Client Forms
            document.getElementById('saveClientBtn').addEventListener('click', saveClient);
            document.getElementById('cancelEditBtn').addEventListener('click', () => showView('client'));
            document.getElementById('saveNewClientBtn').addEventListener('click', addNewClient);
            document.getElementById('cancelAddBtn').addEventListener('click', () => showView('dashboard'));
            
            // Floating Home Button
            document.getElementById('floatingHomeBtn').addEventListener('click', () => showView('dashboard'));
            
            // Allow Enter key to submit forms
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    if (state.currentView === 'login') {
                        handleLogin();
                    } else if (state.currentView === 'register') {
                        handleRegister();
                    }
                }
            });
        }

        // Show a specific view
        function showView(viewName) {
            // Hide all views
            Object.values(views).forEach(view => {
                view.classList.remove('active');
            });
            
            // Show the requested view
            views[viewName].classList.add('active');
            state.currentView = viewName;
            
            // Perform view-specific initializations
            if (viewName === 'dashboard') {
                renderClientList();
            } else if (viewName === 'client' && state.currentClient) {
                renderClientProfile();
                renderCalendar();
            }
        }

        // Handle user login
        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showToast('Please enter both email and password');
                return;
            }
            
            // Find trainer in stored data
            const trainer = state.trainers.find(t => 
                (t.email === email || t.phone === email) && t.password === password
            );
            
            if (trainer) {
                state.currentTrainer = trainer;
                localStorage.setItem('currentTrainer', JSON.stringify(trainer));
                showView('dashboard');
                renderClientList();
                showToast(`Welcome back, ${trainer.name}!`);
            } else {
                showToast('Invalid credentials. Please try again.');
            }
        }

        // Handle user registration
        function handleRegister() {
            const name = document.getElementById('regName').value;
            const phone = document.getElementById('regPhone').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const otp = document.getElementById('regOTP').value;
            
            if (!name || !phone || !email || !password || !otp) {
                showToast('Please fill all fields');
                return;
            }
            
            // Mock OTP verification
            if (otp !== '123456') {
                showToast('Invalid OTP. Please use 123456 for testing.');
                return;
            }
            
            // Check if trainer already exists
            if (state.trainers.some(t => t.email === email)) {
                showToast('A trainer with this email already exists');
                return;
            }
            
            // Create new trainer
            const newTrainer = {
                id: generateId(),
                name,
                phone,
                email,
                password
            };
            
            state.trainers.push(newTrainer);
            localStorage.setItem('zugaTrainers', JSON.stringify(state.trainers));
            
            state.currentTrainer = newTrainer;
            localStorage.setItem('currentTrainer', JSON.stringify(newTrainer));
            
            showView('dashboard');
            renderClientList();
            showToast(`Account created successfully! Welcome, ${name}`);
        }

        // Handle user logout
        function handleLogout() {
            state.currentTrainer = null;
            localStorage.removeItem('currentTrainer');
            showView('login');
            showToast('Logged out successfully');
        }

        // Render the list of clients
        function renderClientList() {
            const clientList = document.getElementById('clientList');
            clientList.innerHTML = '';
            
            if (!state.currentTrainer) return;
            
            const trainerClients = state.clients[state.currentTrainer.id] || [];
            
            if (trainerClients.length === 0) {
                clientList.innerHTML = '<p style="text-align: center; padding: 20px; color: var(--dark-gray);">No clients yet. Add your first client!</p>';
                return;
            }
            
            trainerClients.forEach(client => {
                const li = document.createElement('li');
                li.className = 'client-item';
                li.addEventListener('click', () => {
                    state.currentClient = client;
                    showView('client');
                });
                
                li.innerHTML = `
                    <div style="display: flex; align-items: center;">
                        <div class="client-avatar">${client.name.charAt(0)}</div>
                        <div class="client-info">
                            <div class="client-name">${client.name}</div>
                            <div class="client-details">${client.age} yrs • ${client.gender}</div>
                        </div>
                    </div>
                    <div>▶</div>
                `;
                
                clientList.appendChild(li);
            });
        }

        // Render client profile
        function renderClientProfile() {
            if (!state.currentClient) return;
            
            document.getElementById('clientViewTitle').textContent = state.currentClient.name;
            document.getElementById('clientName').textContent = state.currentClient.name;
            document.getElementById('clientAge').textContent = state.currentClient.age;
            document.getElementById('clientGender').textContent = state.currentClient.gender;
            document.getElementById('clientJoiningDate').textContent = formatDate(state.currentClient.joiningDate);
            document.getElementById('clientRenewalDate').textContent = formatDate(state.currentClient.renewalDate);
            document.getElementById('clientHeight').textContent = state.currentClient.height ? `${state.currentClient.height} cm` : '-';
            document.getElementById('clientWeight').textContent = state.currentClient.weight ? `${state.currentClient.weight} kg` : '-';
            document.getElementById('clientMedical').textContent = state.currentClient.medicalCondition || '-';
            document.getElementById('clientInjuries').textContent = state.currentClient.injuries || '-';
            
            // Set selected date to today if not set
            if (!state.selectedDate) {
                state.selectedDate = new Date().toISOString().split('T')[0];
            }
            
            updateDayInfo();
        }

        // Show edit client form
        function showEditClientForm() {
            if (!state.currentClient) return;
            
            document.getElementById('editClientTitle').textContent = `Edit ${state.currentClient.name}`;
            document.getElementById('editClientName').value = state.currentClient.name;
            document.getElementById('editClientAge').value = state.currentClient.age;
            document.getElementById('editClientGender').value = state.currentClient.gender;
            document.getElementById('editClientJoiningDate').value = state.currentClient.joiningDate;
            document.getElementById('editClientRenewalDate').value = state.currentClient.renewalDate;
            document.getElementById('editClientHeight').value = state.currentClient.height || '';
            document.getElementById('editClientWeight').value = state.currentClient.weight || '';
            document.getElementById('editClientMedical').value = state.currentClient.medicalCondition || '';
            document.getElementById('editClientInjuries').value = state.currentClient.injuries || '';
            
            showView('editClient');
        }

        // Save client details
        function saveClient() {
            if (!state.currentClient) return;
            
            const name = document.getElementById('editClientName').value;
            const age = document.getElementById('editClientAge').value;
            const gender = document.getElementById('editClientGender').value;
            const joiningDate = document.getElementById('editClientJoiningDate').value;
            const renewalDate = document.getElementById('editClientRenewalDate').value;
            const height = document.getElementById('editClientHeight').value;
            const weight = document.getElementById('editClientWeight').value;
            const medicalCondition = document.getElementById('editClientMedical').value;
            const injuries = document.getElementById('editClientInjuries').value;
            
            if (!name || !age || !gender || !joiningDate || !renewalDate) {
                showToast('Please fill all required fields');
                return;
            }
            
            // Update client
            state.currentClient.name = name;
            state.currentClient.age = age;
            state.currentClient.gender = gender;
            state.currentClient.joiningDate = joiningDate;
            state.currentClient.renewalDate = renewalDate;
            state.currentClient.height = height;
            state.currentClient.weight = weight;
            state.currentClient.medicalCondition = medicalCondition;
            state.currentClient.injuries = injuries;
            
            // Save to localStorage
            saveClientsToStorage();
            
            showView('client');
            renderClientProfile();
            showToast('Client details updated successfully');
        }

        // Add a new client
        function addNewClient() {
            const name = document.getElementById('newClientName').value;
            const age = document.getElementById('newClientAge').value;
            const gender = document.getElementById('newClientGender').value;
            const joiningDate = document.getElementById('newClientJoiningDate').value;
            const renewalDate = document.getElementById('newClientRenewalDate').value;
            const height = document.getElementById('newClientHeight').value;
            const weight = document.getElementById('newClientWeight').value;
            const medicalCondition = document.getElementById('newClientMedical').value;
            const injuries = document.getElementById('newClientInjuries').value;
            
            if (!name || !age || !gender || !joiningDate || !renewalDate) {
                showToast('Please fill all required fields');
                return;
            }
            
            // Create new client
            const newClient = {
                id: generateId(),
                name,
                age,
                gender,
                joiningDate,
                renewalDate,
                height,
                weight,
                medicalCondition,
                injuries,
                attendance: {}
            };
            
            // Add to trainer's clients
            if (!state.clients[state.currentTrainer.id]) {
                state.clients[state.currentTrainer.id] = [];
            }
            
            state.clients[state.currentTrainer.id].push(newClient);
            saveClientsToStorage();
            
            showView('dashboard');
            renderClientList();
            showToast(`Client ${name} added successfully`);
            
            // Reset form
            document.getElementById('newClientName').value = '';
            document.getElementById('newClientAge').value = '';
            document.getElementById('newClientGender').value = '';
            document.getElementById('newClientHeight').value = '';
            document.getElementById('newClientWeight').value = '';
            document.getElementById('newClientMedical').value = '';
            document.getElementById('newClientInjuries').value = '';
        }

        // Render calendar
        function renderCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            const monthYear = document.getElementById('calendarMonth');
            
            // Set month/year header
            const options = { year: 'numeric', month: 'long' };
            monthYear.textContent = state.currentDate.toLocaleDateString('en-US', options);
            
            // Clear calendar
            calendarGrid.innerHTML = '';
            
            // Get first day of month and number of days
            const firstDay = new Date(state.currentDate.getFullYear(), state.currentDate.getMonth(), 1);
            const lastDay = new Date(state.currentDate.getFullYear(), state.currentDate.getMonth() + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDay = firstDay.getDay(); // 0 = Sunday, 1 = Monday, etc.
            
            // Add empty cells for days before the first day of the month
            for (let i = 0; i < startingDay; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.className = 'calendar-day empty';
                calendarGrid.appendChild(emptyCell);
            }
            
            // Add cells for each day of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayCell = document.createElement('div');
                dayCell.className = 'calendar-day';
                dayCell.textContent = day;
                
                // Format date as YYYY-MM-DD
                const dateStr = `${state.currentDate.getFullYear()}-${(state.currentDate.getMonth() + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                
                // Check if this date is selected
                if (dateStr === state.selectedDate) {
                    dayCell.classList.add('selected');
                }
                
                // Check attendance status for this date
                if (state.currentClient.attendance && state.currentClient.attendance[dateStr]) {
                    const status = state.currentClient.attendance[dateStr].status;
                    dayCell.classList.add(status);
                }
                
                dayCell.addEventListener('click', () => {
                    // Remove selected class from all days
                    document.querySelectorAll('.calendar-day').forEach(cell => {
                        cell.classList.remove('selected');
                    });
                    
                    // Add selected class to clicked day
                    dayCell.classList.add('selected');
                    
                    // Update selected date
                    state.selectedDate = dateStr;
                    updateDayInfo();
                });
                
                calendarGrid.appendChild(dayCell);
            }
        }

        // Navigate to previous month
        function prevMonth() {
            state.currentDate.setMonth(state.currentDate.getMonth() - 1);
            renderCalendar();
        }

        // Navigate to next month
        function nextMonth() {
            state.currentDate.setMonth(state.currentDate.getMonth() + 1);
            renderCalendar();
        }

        // Update day info based on selected date
        function updateDayInfo() {
            if (!state.selectedDate) return;
            
            const selectedDateElement = document.getElementById('selectedDate');
            const attendanceSelect = document.getElementById('attendanceSelect');
            const workoutNotes = document.getElementById('workoutNotes');
            
            // Format and display selected date
            const date = new Date(state.selectedDate);
            selectedDateElement.textContent = date.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            // Set attendance and notes if they exist
            if (state.currentClient.attendance && state.currentClient.attendance[state.selectedDate]) {
                const dayData = state.currentClient.attendance[state.selectedDate];
                attendanceSelect.value = dayData.status;
                workoutNotes.value = dayData.notes || '';
            } else {
                attendanceSelect.value = '';
                workoutNotes.value = '';
            }
        }

        // Save day info (attendance and notes)
        function saveDayInfo() {
            if (!state.selectedDate || !state.currentClient) return;
            
            const attendance = document.getElementById('attendanceSelect').value;
            const notes = document.getElementById('workoutNotes').value;
            
            if (!attendance) {
                showToast('Please select an attendance status');
                return;
            }
            
            // Initialize attendance object if it doesn't exist
            if (!state.currentClient.attendance) {
                state.currentClient.attendance = {};
            }
            
            // Save day info
            state.currentClient.attendance[state.selectedDate] = {
                status: attendance,
                notes: notes
            };
            
            // Save to localStorage
            saveClientsToStorage();
            
            // Update calendar display
            renderCalendar();
            
            showToast('Day info saved successfully');
        }

        // Download monthly report
        function downloadMonthlyReport() {
            if (!state.currentClient) return;
            
            // Create a simple report in a new window
            const reportWindow = window.open('', '_blank');
            const monthYear = state.currentDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long' });
            
            let reportHTML = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Monthly Report - ${state.currentClient.name} - ${monthYear}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        h1 { color: #00bfa6; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                        th { background-color: #f2f2f2; }
                        .present { background-color: #4caf50; color: white; }
                        .absent { background-color: #f44336; color: white; }
                        .holiday { background-color: #ff9800; color: white; }
                        .freeze { background-color: #2196f3; color: white; }
                    </style>
                </head>
                <body>
                    <h1>Zuga Fitness - Monthly Report</h1>
                    <h2>${state.currentClient.name} - ${monthYear}</h2>
                    
                    <h3>Client Details</h3>
                    <p><strong>Age:</strong> ${state.currentClient.age}</p>
                    <p><strong>Gender:</strong> ${state.currentClient.gender}</p>
                    <p><strong>Height:</strong> ${state.currentClient.height || 'N/A'} cm</p>
                    <p><strong>Weight:</strong> ${state.currentClient.weight || 'N/A'} kg</p>
                    
                    <h3>Attendance Summary</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            // Get all dates in the current month
            const firstDay = new Date(state.currentDate.getFullYear(), state.currentDate.getMonth(), 1);
            const lastDay = new Date(state.currentDate.getFullYear(), state.currentDate.getMonth() + 1, 0);
            const daysInMonth = lastDay.getDate();
            
            let presentCount = 0;
            let absentCount = 0;
            let holidayCount = 0;
            let freezeCount = 0;
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${state.currentDate.getFullYear()}-${(state.currentDate.getMonth() + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                const date = new Date(dateStr);
                const dayData = state.currentClient.attendance ? state.currentClient.attendance[dateStr] : null;
                
                let status = 'Not Recorded';
                let statusClass = '';
                let notes = '';
                
                if (dayData) {
                    status = dayData.status.charAt(0).toUpperCase() + dayData.status.slice(1);
                    statusClass = dayData.status;
                    notes = dayData.notes || '';
                    
                    // Count statuses
                    switch(dayData.status) {
                        case 'present': presentCount++; break;
                        case 'absent': absentCount++; break;
                        case 'holiday': holidayCount++; break;
                        case 'freeze': freezeCount++; break;
                    }
                }
                
                reportHTML += `
                    <tr>
                        <td>${date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })}</td>
                        <td class="${statusClass}">${status}</td>
                        <td>${notes}</td>
                    </tr>
                `;
            }
            
            reportHTML += `
                        </tbody>
                    </table>
                    
                    <h3>Summary</h3>
                    <p><strong>Present:</strong> ${presentCount} days</p>
                    <p><strong>Absent:</strong> ${absentCount} days</p>
                    <p><strong>Holiday:</strong> ${holidayCount} days</p>
                    <p><strong>Freeze:</strong> ${freezeCount} days</p>
                    <p><strong>Total Recorded:</strong> ${presentCount + absentCount + holidayCount + freezeCount} of ${daysInMonth} days</p>
                    
                    <p style="margin-top: 30px; font-style: italic;">Generated on ${new Date().toLocaleDateString()} by Zuga Fitness Trainer</p>
                </body>
                </html>
            `;
            
            reportWindow.document.write(reportHTML);
            reportWindow.document.close();
            
            // Trigger print dialog
            setTimeout(() => {
                reportWindow.print();
            }, 500);
            
            showToast('Monthly report generated');
        }

        // Save clients to localStorage
        function saveClientsToStorage() {
            localStorage.setItem('zugaClients', JSON.stringify(state.clients));
        }

        // Show toast message
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Generate a unique ID
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        // Format date as DD/MM/YYYY
        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-GB');
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);

        // PWA Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>

    <!-- Inline Service Worker for PWA -->
    <script id="sw-script">
        // This would normally be in a separate file, but for single-file app we create it dynamically
        if ('serviceWorker' in navigator) {
            const swContent = `
                self.addEventListener('install', event => {
                    event.waitUntil(
                        caches.open('zuga-fitness-v1').then(cache => {
                            return cache.addAll([
                                './',
                                './index.html'
                            ]);
                        })
                    );
                });

                self.addEventListener('fetch', event => {
                    event.respondWith(
                        caches.match(event.request).then(response => {
                            return response || fetch(event.request);
                        })
                    );
                });
            `;

            const blob = new Blob([swContent], { type: 'application/javascript' });
            const swURL = URL.createObjectURL(blob);
            
            navigator.serviceWorker.register(swURL)
                .then(registration => console.log('SW registered'))
                .catch(error => console.log('SW registration failed'));
        }
    </script>

    <!-- PWA Manifest -->
    <script type="application/json" id="manifest">
        {
            "name": "Zuga Fitness Trainer",
            "short_name": "Zuga Fitness",
            "description": "Fitness trainer client management app",
            "start_url": "./",
            "display": "standalone",
            "background_color": "#ffffff",
            "theme_color": "#00bfa6",
            "orientation": "portrait-primary",
            "icons": [
                {
                    "src": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiMwMEJGQTYiLz4KPHBhdGggZD0iTTk2IDU2QzEwNy4wNDYgNTYgMTE2IDY0Ljk1NDUgMTE2IDc2VjExNkMxMTYgMTI3LjA0NiAxMDcuMDQ2IDEzNiA5NiAxMzZDODQuOTU0NSAxMzYgNzYgMTI3LjA0NiA3NiAxMTZWNzZDNzYgNjQuOTU0NSA4NC45NTQ1IDU2IDk2IDU2WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTY0IDk2QzY0IDg0Ljk1NDUgNzIuOTU0NSA3NiA4NCA3NkgxMDhDMTE5LjA0NiA3NiAxMjggODQuOTU0NSAxMjggOTZWMTE2QzEyOCAxMjcuMDQ2IDExOS4wNDYgMTM2IDEwOCAxMzZIODRDNzIuOTU0NSAxMzYgNjQgMTI3LjA0NiA2NCAxMTZWOTZaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K",
                    "sizes": "192x192",
                    "type": "image/svg+xml"
                },
                {
                    "src": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiByeD0iNjQiIGZpbGw9IiMwMEJGQTYiLz4KPHBhdGggZD0iTTI1NiAxNDhDMjkxLjM0NyAxNDggMzIwIDE3Ni42NTMgMzIwIDIxMlYzMDhDMzIwIDM0My4zNDcgMjkxLjM0NyAzNzIgMjU2IDM3MkMyMjAuNjUzIDM3MiAxOTIgMzQzLjM0NyAxOTIgMzA4VjIxMkMxOTIgMTc2LjY1MyAyMjAuNjUzIDE0OCAyNTYgMTQ4WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTE3MiAyNTZDMTcyIDI0NC45NTQgMTgwLjk1NCAyMzYgMTkyIDIzNkgyODhDMjk5LjA0NiAyMzYgMzA4IDI0NC45NTQgMzA4IDI1NlYzMDhDMzA4IDMxOS4wNDYgMjk5LjA0NiAzMjggMjg4IDMyOEgxOTJDMTgwLjk1NCAzMjggMTcyIDMxOS4wNDYgMTcyIDMwOFYyNTZaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K",
                    "sizes": "512x512",
                    "type": "image/svg+xml"
                }
            ]
        }
    </script>

    <script>
        // Create manifest link dynamically
        const manifestContent = document.getElementById('manifest').textContent;
        const manifestBlob = new Blob([manifestContent], { type: 'application/json' });
        const manifestURL = URL.createObjectURL(manifestBlob);
        
        const link = document.createElement('link');
        link.rel = 'manifest';
        link.href = manifestURL;
        document.head.appendChild(link);
    </script>
</body>
</html>
